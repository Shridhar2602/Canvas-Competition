<html>

<body onload="canvas.setup()">

    <canvas id="canvasArea1" style="position: absolute; left: 0; top: 0; z-index: 0; width:100%;height:100% ">
    </canvas>
    <canvas id="canvasArea2"
        style="visibility: hidden; position: absolute; left: 0; top: 0; z-index: 0; width:100%;height:100%"></canvas>

    <script src="./canvas.js"></script>
</body>

</html>
<script>

    // Declare all global variables here
    var focus = 50;

    function setup() 
    {
        // Initialize variables here
        obj_x1 = 0;
        obj_y1 = canvas.height/2;
        obj_x2 = canvas.width;
        obj_y2 = canvas.height/2;
    }

    function drawDottedLine (x1, y1, x2, y2) 
    {
      canvas.ctx.beginPath();
      canvas.ctx.setLineDash([5,5]);
      canvas.ctx.moveTo(x1, y1);
      canvas.ctx.lineTo(x2, y2);
      canvas.draw();
    }

    // Declare custom functions here

    function draw_convex_lens(){
      canvas.drawLine(0, canvas.height/2, canvas.width, canvas.height/2);
      canvas.drawLine(canvas.width/2, 0, canvas.width/2, canvas.height);
      

      canvas.drawEllipse(canvas.width/2, canvas.height/2, 20,100, Math.PI/2, 0, 2*Math.PI);
    }

    function object(){
      canvas.drawLine(canvas.mouseX ,canvas.height/2, canvas.mouseX, canvas.mouseY);
    }

    function ray_through_origin()
    {
      canvas.drawLine(canvas.mouseX, canvas.mouseY, canvas.width/2, canvas.height/2);

      if (canvas.mouseX <= canvas.width/2)
      {
        var slope = (canvas.height/2 - canvas.mouseY) / (canvas.width/2 - canvas.mouseX);
        var intercept = (canvas.height/2 - slope*canvas.width/2);
        canvas.drawLine(canvas.width/2, canvas.height/2, canvas.width, slope*canvas.width + intercept);
      }
      else 
      {
        var slope = (canvas.height/2 - canvas.mouseY) / (canvas.width/2 - canvas.mouseX);
        var intercept = (canvas.height/2 - slope*canvas.width/2);
        canvas.drawLine(canvas.width/2, canvas.height/2, 0, slope*0 + intercept);
      }
    }

    function ray_through_focus()
    {
      canvas.drawLine(canvas.mouseX, canvas.mouseY, canvas.width/2, canvas.mouseY);

      if (canvas.mouseX <= canvas.width/2)
      { 
        canvas.drawLine(canvas.width/2, canvas.mouseY, canvas.width/2 + focus, canvas.height/2 )
        var slope = (canvas.height/2 - canvas.mouseY) / (canvas.width/2 + focus - canvas.width/2);
        var intercept = (canvas.height/2 - slope*(canvas.width/2 + focus));
        canvas.drawLine(canvas.width/2 + focus, canvas.height/2, canvas.width, slope*canvas.width + intercept);
        
        if(canvas.mouseX > (canvas.width/2 - focus))
        {
          drawDottedLine(canvas.width/2, canvas.mouseY, 0, slope*0 + intercept);
        }
      }
      else 
      {
        canvas.drawLine(canvas.width/2, canvas.mouseY, canvas.width/2 - focus, canvas.height/2 )
        var slope = (canvas.height/2 - canvas.mouseY) / (canvas.width/2 - focus - canvas.width/2);
        var intercept = (canvas.height/2 - slope*(canvas.width/2 - focus));
        canvas.drawLine(canvas.width/2 - focus, canvas.height/2, 0, slope*0 + intercept);
      }
    }

    // Function while will be called repeatedly 
    function main() 
    {
        canvas.clear();
        draw_convex_lens();
        canvas.mouseMoveCallback = object();
        canvas.mouseMoveCallback = ray_through_origin();
        canvas.mouseMoveCallback = ray_through_focus();
    }

    // Override functions here; 
    canvas.mainFunction = main;

    var timeStep = 1;
    canvas.startMain(timeStep);
    canvas.setupFunction = setup;

</script>